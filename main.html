<html
    window-frame="extended"
    window-resizable="true"
    window-width="750dip"
    window-height="1024dip"
    window-state="maximized"
    window-icon="images/seastar.svg"
    window-blurbehind="light"
    theme="light">
<head>
<title>sciter demo</title>
<style>

@import url(vendor/8ctopus/sciter-logger/src/logger.css);
@import url(css/controls.css);
@import url(css/window.css);

.hbox {
    margin-right: 1em;
    flow: horizontal;
    border-spacing: 0.5em;
    vertical-align: middle;
}

plaintext#logger {
    height: 10%;
}

</style>
<script type="module">

import {logger} from "vendor/8ctopus/sciter-logger/src/logger.js";
import * as utils from "vendor/8ctopus/sciter-utils/src/utils.js";

// initialize logger
logger.init();

// attach logger to console
logger.attach();

// capture unhandled exceptions
logger.capture(unhandledExceptionHandler);

document.ready = function() {
    // subscribe to logger messages
    logger.plaintext(document.$("plaintext#logger"));

    // log sciter version
    console.debug(utils.sciterInfo());

    // add support for F5 reload
    utils.addReloadWindow();

    // close window on escape key press
    utils.closeWindowOnEscape(Window.this);

    // center window on screen
    utils.centerWindow(Window.this, "screen");

    // bring window to front
    //utils.windowToFront(Window.this);

    // bring window to front and set input focus
    Window.this.activate(true);

    //console.debug(isStrict() ? "strict js" : "loose js");

    console.debug("Document ready - OK");
}

document.on("input", "form#config", function(evt, form) {
    // set document light/dark mode
    document.attributes["theme"] = form.value.mode;

    // get frame
    const frame = document.$("frame");

    // set frame theme
    frame.attributes["content-style"] = form.value.theme;

    const url = frame.frame.document.url();

    console.debug(url);

    // reload frame
    frame.frame.loadFile(url);

    // set frame theme UI size
    frame.frame.document.attributes["ui-size"] = form.value.size;
});

/**
 * Test if strict javascript is used
 * @return true if strict, false otherwise
 * @note https://stackoverflow.com/a/18916788/10126479
 */
function isStrict()
{
    return eval("var __temp = null"), (typeof __temp === "undefined");
}

/**
 * Unhandled exception handler
 * @param  Error|String e
 * @return void
 */
function unhandledExceptionHandler(e)
{
    // log exception using exception if it exists, error otherwise
    typeof console.exception === "function" ? console.exception(e) : console.error(e);
}

</script>
</head>
<include src="window.html" media="sciter" />
<body>
    <p> This is a sciter demo app based on multiple examples. </p>
    <form #config .hbox>
        <div .hbox>
            Theme:
            <select|dropdown(theme)>
                <option value="default" value="css/themes/default-unisex.css" selected>default</option>
                <option value="flat" value="css/themes/windows-flat.css">Windows Flat</option>
                <option value="material" value="css/themes/android-material.css">Android/Material</option>
            </select>
        </div>
        <div .hbox>
            Mode:
            <button|radio(mode) checked value="light">Light</button>
            <button|radio(mode) value="dark">Dark</button>
        </div>
        <div .hbox>
            Size:
            <button|radio(size) checked value="normal">Normal</button>
            <button|radio(size) value="compact">Compact</button>
        </div>
    </form>

    <frame src="elements.html" content-style="css/themes/default-unisex.css" />

    <plaintext #logger readonly />
</body>
</html>
